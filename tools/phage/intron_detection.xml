<?xml version="1.1"?>
<tool id="edu.tamu.cpt2.phage.intron_detection" name="Intron Detection" version="19.1.0.0">
  <description>based on nearby protein blast results</description>
  <macros>
    <import>macros.xml</import>
		<import>cpt-macros.xml</import>
  </macros>
  <requirements>
        <requirement type="package" version="2.7">python</requirement>
	<requirement type="package" version="1.74">biopython</requirement>
	<requirement type="package" version="0.6.4">bcbiogff</requirement>
  </requirements>
  <command detect_errors="aggressive"><![CDATA[
python $__tool_directory__/intron_detection.py

"$gff3_data"
"$blast"
--minimum $minimum
--maximum $maximum
> $output]]></command>
  <inputs>
    <expand macro="gff3_input" />
    <param label="Blastp Results" name="blast" type="data" format="blastxml"/>
    <param label="Separation Minimum" name="minimum" type="integer" value="-1"
        help="Minimum number of amino acids a CDS pair may be separated by to detect an intron. Set to a negative number to instead allow CDS to overlap by up to that many bases."/>
    <param label="Separation Maximum" name="maximum" type="integer" value="2000"
        help="Maximum number of bases a CDS pair may be separated by to detect an intron."/>
  </inputs>
  <outputs>
    <data format="gff3" name="output" label="Putative introns"/>
  </outputs>
  <help><![CDATA[
**What it does**

This tool parses BLAST XML results and returns potential intron regions by 
identifying query proteins (within 10 genes of each other in the genome) with 
BLAST hits to the same target protein. The list of hits is returned as a gff3.

      ]]></help>
		<expand macro="citations-2020" />
</tool>
