<?xml version="1.1"?>
<tool id="edu.tamu.cpt2.spanin.generate-putative-isp" name="ISP candidates" version="1.0">
    <description>constructs a putative list of potential i-spanin from an input genomic FASTA</description>
    <macros>
		<import>macros.xml</import>
		<import>cpt-macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <command detect_errors="aggressive"><![CDATA[
python $__tool_directory__/generate-putative-isp.py
$fasta_file
--isp_min_len $isp_min_len
--isp_min_dist $isp_min_dist
--isp_max_dist $isp_max_dist
--min_tmd_size $min_tmd_size
--max_tmd_size $max_tmd_size
--putative_isp $putative_isp

> $output]]></command>
    <inputs>
        <param label="FASTA" name="fasta_file" type="data" format="fasta" />
	<param label="i-spanin minimal length" name="isp_min_len" type="integer" value="60" />
        <param label="TMD minimal distance from start codon" name="isp_min_dist" type="integer" value="10" />
	<param label="TMD maximum distance from start codon" name="isp_max_dist" type="integer" value="30" />
        <param label="TMD minimal size" name="min_tmd_size" type="integer" value="10" />
    <param label="TMD maximum size" name="max_tmd_size" type="integer" value="20" />

    </inputs>
    <outputs>
		<data format="fasta" name="putative_isp" label="putative_isp.fa"/>
    </outputs>
    <help><![CDATA[
**What it does**
INPUT : Genomic FASTA
METHODOLOGY
Uses the `OrfFinder` object and locates __ALL__ potential start sequences, based on `ttg` / `atg` / `gtg`
This generates a set of output files consisting of FASTA / BED / GFF3 
With the aaFASTA, we read in each potential sequence and determine if it has a TMD based off of:
    1. Ciphs through looking for Lysine snorkels, of a range 1 - 7 upstream of the selected sequence (the minimal distance / max distance from start codon). If it finds a lysine, it looks to see if there is a hydrophobic neighbor, and then looks upstream for a range of transmembrane size - 6 to transmembrane size - 1, and verifies if there is another snorkeling lysine with a hydrophobic neighbor. This is intended to cast a large net. If this passes, the description/sequence is saved.
    2. Looks for a repeated hydrophobic region within the sequence, based on a range of user inputs (example, transmembrane size 6 - 20, will look for [hydrophobic-AAs]x6 through [hydrophobic-AAs]x20). If this passes, the description/sequence is saved.
OUTPUT : putative_isp.fa (FASTA) file.
        ]]></help>
        <expand macro="citations-2020" />
</tool>