<tool id="LipoP" name="LipoP" version="1.0.0">
        <description>program for prediction of lipoproteins and for discriminating between lipoprotein signalpetides, other signal peptides and n-terminal membrane helices in Gram negative bacteria.</description>
        <command>
		cat $infile | LipoP $html -galaxy -galaxyhtmlfile "$html_file" -galaxyhtmlfolder "$html_file.files_path" > "$html_file"
        </command>
        <inputs>
        	<param name="infile" optional="False" type="data" format="fasta" label="Input Fasta File" />
		    <param name="html" type="boolean" truevalue="-html" falsevalue="" label="HTML Output" />
        </inputs>
        <outputs>
            <data format="html" name="html_file" label="LipoP Output">
                    <change_format>
                        <when input="html" value="" format="txt"/>
                        <when input="html" value="-html" format="html"/>
                    </change_format>
            </data>
        </outputs>
        <help>

.. class:: infomark

**What it does**

Uses LipoP version 1.0

The program takes proteins in FASTA format. It  recognizes the 20 amino acids and B, Z, and X, which are all treated equally as unknown. Any other character is changed to X, so please make sure  the  sequences  are  sensible
proteins

This is an example (one protein)::

    >5H2A_CRIGR you can have comments after the ID
    MEILCEDNTSLSSIPNSLMQVDGDSGLYRNDFNSRDANSSDASNWTIDGENRTNLSFEGYLPPTCLSILHL
    QEKNWSALLTAVVIILTIAGNILVIMAVSLEKKLQNATNYFLMSLAIADMLLGFLVMPVSMLTILYGYRWP
    LPSKLCAVWIYLDVLFSTASIMHLCAISLDRYVAIQNPIHHSRFNSRTKAFLKIIAVWTISVGVSMPIPVF
    GLQDDSKVFKQGSCLLADDNFVLIGSFVAFFIPLTIMVITYFLTIKSLQKEATLCVSDLSTRAKLASFSFL
    PQSSLSSEKLFQRSIHREPGSYTGRRTMQSISNEQKACKVLGIVFFLFVVMWCPFFITNIMAVICKESCNE
    HVIGALLNVFVWIGYLSSAVNPLVYTLFNKTYRSAFSRYIQCQYKENRKPLQLILVNTIPALAYKSSQLQA
    GQNKDSKEDAEPTDNDCSMVTLGKQQSEETCTDNINTVNEKVSCV

-----

.. class:: warningmark

**Note**

Only the first 70 amino acids are used for prediction.

-----

**Output**

The output format is essentially in GFF format. The default (long) output format looks like this::

    # ANIA_NEIGO SpII score=29.6052 margin=11.2327 cleavage=18-19 Pos+2=G
    # Cut-off=-3
    ANIA_NEIGO  LipoP1.0:Best   SpII    1   1   29.6052
    ANIA_NEIGO  LipoP1.0:Margin SpII    1   1   11.2327
    ANIA_NEIGO  LipoP1.0:Class  SpI 1   1   18.3725
    ANIA_NEIGO  LipoP1.0:Class  CYT 1   1   -0.200913
    ANIA_NEIGO  LipoP1.0:Signal CleavII 18  19  29.6052 # FALAA|CGGEQ Pos+2=G
    ANIA_NEIGO  LipoP1.0:Signal CleavI  24  25  18.0333 # GGEQA|AQAPA
    ANIA_NEIGO  LipoP1.0:Signal CleavI  20  21  15.9259 # LAACG|GEQAA
    ANIA_NEIGO  LipoP1.0:Signal CleavI  26  27  12.0794 # EQAAQ|APAET
    ANIA_NEIGO  LipoP1.0:Signal CleavI  25  26  11.4077 # GEQAA|QAPAE
    ANIA_NEIGO  LipoP1.0:Signal CleavI  27  28  9.40252 # QAAQA|PAETP
    (output trunctated)

The first line, which is the only line if short output is chosen, summarizes the best prediction. In the example the best prediction is a lipoprotein with a cleavage site between amino  acid  18  and  19  and  amino  acid  G
(glycine) in position +2 after the cleavage site. The second line gives the cut-off used. In the following the columns contain

1. Sequence  ID
2. Type of prediction. Best means the highest scoring class, Margin gives the difference between the best score and the second best score, Class gives the score of other classes and Signal lines contain pre‐dicted cleavage sites.
3. Feature type, see below
4. Location in the sequence. For lines with a class prediction it is always 1. For cleavage sites it is the last amino acid of the signal peptide relative to  the  predicted cleavage site.
5. Location as above axcept that for cleavage sites it is the first amino acids after the cleavage site.
6. Score. For the "Margin" type it is the difference between the best and the second best class score. Otherwise the log-odds score.
7. For the cleavage sites the ±5 context is shown after the #, and for lipoprotein cleavage sites the amino acid in postition +2 is  shown  (which  may  determine  whether  the  lipoprotein  is attached to the inner or outer membrane, see below.

These 4 clases are predicted

SpI
  signal peptide (signal peptidase I)
SpII
  lipoprotein signal peptide (signal peptidase II)
TMH
  n-terminal transmembrane helix. This is generally not a very reliable prediction and should be tested. This part of the model is mainly there to avoid tranmembrane helices being falsely predicted as signal peptides.
CYT
  cytoplasmic. It really just means all the rest.

For technical reasons (see paper) the score for CYT is always the same.

These signals are predicted:

CleavI
  Cleavage sites for (signal peptidase I).
CleavII
  Cleavage sites for (signal peptidase II).


        </help>
    <citations>
        <citation type="bibtex">
            @unpublished{galaxyTools,
                author = {A. S. Juncker, H. Willenbrock, G. von Heijne, H. Nielsen, S. Brunak and A. Krogh.},
                title = {Prediction of lipoprotein signal peptides in Gram-negative bacteria},
                year = {2003},
                note = {Protein Sci. 12(8):1652-62}
            }
        </citation>
    </citations>
</tool>
