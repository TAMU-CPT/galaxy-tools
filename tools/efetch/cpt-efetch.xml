<tool id="edu.tamu.cpt.efetch.cpt-efetch" name="CPT EFetch (ALPHA)" version="1.0">
    <description>CPT's revised NCBI EFetch</description>
    <macros>
        <requirement type="package" version="1.65">biopython</requirement>
    </macros>
    <command detect_errors="aggressive"><![CDATA[
python $__tool_directory__/cpt-efetch.py
email $email
--input $input
--db $db
--ret_format $ret_format
--ret_type $ret_type
--sleep $sleep
--galaxy_on 

    ]]></command>
        <inputs>
            <param type="text" name="input" label="NCBI Protein or Genome Accession" area="true" help="Custom text box for accessions, must be separated by newline (enter)"/>
            <param type="select" label="NCBI Database to Query" name="db">
                <option value="protein">Protein</option>
                <option value="nuccore">Nucleotide</option>
            </param>
            <param type="select" label="File(s) Retrieved Type" name="ret_type">
                <option value="fasta">FASTA</option>
                <option value="genbank">Genbank</option>
            </param>
            <param type="select" label="Format of your returned Files" name="ret_format">
                <option value="individual">Return each file individually</option>
                <option value="multi">Return a multi-genbank or multi-fasta</option>
                <option value="both">Return both individual and multi versions</option>
            </param>
            <param name="sleep" type="integer" value="20" label="Amount to slow request to NCBI by" />
        </inputs>
        <outputs>
            <conditional name="ret_format.individual">
                <conditional name="ret_type.fasta">
                    <data name="data" format="txt">
                        <discover_datasets pattern="__designation__" format="fasta" directory="results" visible="true" />
                    </data>
                </conditional>
                <conditional name="ret_type.genbank">
                    <data name="data" format="txt">
                        <discover_datasets pattern="__designation__" format="genbank" directory="results" visible="true" />
                    </data>
                </conditional>
            </conditional>
            <conditional name="ret_format.multi">
                <conditional name="ret_type.fasta">
                    <data name="data" format="txt">
                        <discover_datasets pattern="__designation__" format="fasta" directory="results" visible="false" />
                        <discover_datasets pattern="(outputMulti)" format="fasta" directory="results" visible="true" />
                    </data>
                </conditional>
                <conditional name="ret_type.genbank">
                    <data name="data" format="txt">
                        <discover_datasets pattern="__designation__" format="genbank" directory="results" visible="false" />
                        <discover_datasets pattern="(outputMulti)" format="genbank" directory="results" visible="true" />
                    </data>
                </conditional>
            </conditional>
            <conditional name="ret_format.both">
                <conditonal name="ret_type.fasta">
                    <data name="data" format="txt">
                        <discover_datasets pattern="__designation__" format="fasta" directory="results" visible="true" />
                        <discover_datasets pattern="(outputMulti)" format="fasta" directory="results" visible="true" />
                    </data>
                </conditional>
                <conditonal name="ret_type.genbank">
                    <data name="data" format="txt">
                        <discover_datasets pattern="__designation__" format="genbank" directory="results" visible="true" />
                        <discover_datasets pattern="(outputMulti)" format="genbank" directory="results" visible="true" />
                    </data>
                </conditional>
            </conditional>
        </outputs>
        <tests>
        </tests>
    <help><![CDATA[
INPUT : An accession, or set of accessions separated by new line. 

- Current version has manual entry of email. Due to the following (from NCBI): To make use of NCBI's E-utilities, NCBI requires you to specify your email address with each request. In case of excessive usage of the E-utilities, NCBI will attempt to contact a user at the email address provided before blocking access to the E-utilities.

OUTPUT : Requested file type (genbank or fasta) individually and/or combined together.

    ]]></help>
        <citations>
            <citation type="bibtex">
                @unpublished{galaxyTools,
                author = {C. Ross},
                title = {CPT Galaxy Tools},
                year = {2020-},
                note = {https://github.com/tamu-cpt/galaxy-tools/}
                }
            </citation>
        </citations>
</tool>
