<?xml version="1.0"?>
<tool id="edu.tamu.cpt.gbk.gbk_compare" name="Compare Genbanks" version="20.1.0">
  <description>, compare the identity of two genbank files</description>
  <macros>
    <import>macros.xml</import>
    <import>cpt-macros.xml</import>
  </macros>
  <requirements>
      <requirement type="package" version="3.7">python</requirement>
      <requirement type="package" version="1.74">biopython</requirement>
  </requirements>
  <command detect_errors="aggressive"><![CDATA[
python $__tool_directory__/gbk_compare.py
$annotation_1
$annotation_2
--match_identity_threshold $match_identity_threshold
--allowed_skipped_genes $allowed_skipped_genes
-sumOut $sumOut
> $repOut]]></command>
  <inputs>
    <param label="First annotated genome (Genbank)" name="annotation_1" type="data" format="genbank"/>
    <param label="Second annotated genome (Genbank)" name="annotation_2" type="data" format="genbank"/>
    <param label="Two genes must have at least this identity to be considerd the same (0.00 to 1.00)" name="match_identity_threshold" type="float" value="0.70" min="0.00" max="1.00"/>
    <param label="This many missing genes are allowed when aligning the annotations" name="allowed_skipped_genes" type="integer" value="10"/>
  </inputs>
  <outputs>
    <data format="tsv" name="sumOut" label="Report Summary"/>
    <data format="txt" name="repOut" label="Comparison Report of Two Genomes"/>
  </outputs>
  <tests>
      
  </tests>
  <help><![CDATA[
**What it does**

This script quantifies the improvements in an annotation for when a genome is reassembled and/or reannotated. It does a global alignment (using pairwise2 from biopython) of the genes of one annotation to the other. It does mean that the genomes must be roughly aligned at the gene level. If there are structural rearragements, the script will not work. The script was written by Ryan Wick from Monash University and was adapted to work on Galaxy.

**Input**

Files *MUST* be in gebank format.
The script only looks at CDS features in the genome.

**Output**

* A tab delimited file of the results
* Summary of the results.
]]></help>
  <citations>
    <citation type="bibtex">
      @unpublished{galaxyTools,
      author = {R. Wick},
      title = {CPT Galaxy Tools},
      year = {2020},
      note = {https://github.com/rrwick}
      }
    </citation>
  </citations>
</tool>
